#!/usr/bin/make -f
#
# debian/rules for ucblogo package

DH_COMPAT=3
export DH_COMPAT

build:
	dh_testdir
	./configure
	$(MAKE) LIBLOC=/usr/share/ucblogo CFLAGS="-O2 -Wall -g"
	touch build

clean:
	dh_testdir
	$(MAKE) -i clean || $(MAKE) -i -f makefile.in clean
	-rm -f build
	-rm -f makefile config.h config.cache config.log config.status \
		core logo makehelp helpfiles/HELPCONTENTS
	-rm -rf *~ debian/ucblogo debian/{*~,files*,substvars}
	# -rm -rf helpfiles
	dh_clean

binary-indep: checkroot build
# None
	@echo 'No architecture independend package components.'; false

binary binary-arch: build
	dh_testdir
	dh_testroot
	dh_clean

	dh_installdirs
	# install -s logo debian/ucblogo/usr/bin/ucblogo
	# cp -r helpfiles/* debian/ucblogo/usr/share/ucblogo/helpfiles/.
	# cp -r logolib/* debian/ucblogo/usr/share/ucblogo/logolib/.
	# cp -r csls/* debian/ucblogo/usr/share/ucblogo/csls/.

	$(MAKE) install BINDIR=debian/ucblogo/usr/bin LIBLOC=debian/ucblogo/usr/share/ucblogo
	mv debian/ucblogo/usr/bin/logo debian/ucblogo/usr/bin/ucblogo
	ln -s ucblogo debian/ucblogo/usr/bin/logo

	dh_installmanpages
	ln -s ucblogo.1.gz debian/ucblogo/usr/share/man/man1/logo.1.gz

	cp emacs/docs/*.pdf debian/ucblogo/usr/share/doc/ucblogo
	cp emacs/docs/*.html debian/ucblogo/usr/share/doc/ucblogo/html

	dh_installdocs README
	cp usermanual debian/ucblogo/usr/share/doc/ucblogo/usermanual.txt
	dh_installchangelogs

	dh_strip
	dh_compress
	dh_fixperms
	dh_installdeb
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

.PHONY: binary binary-arch binary-indep clean checkroot

